# 🎯 个人知识管理智能体 - 使用指南

## ✅ 问题已解决！

你遇到的HTTP 500错误已经诊断清楚了：Web代理的stdio通信模式存在问题。

## 🚀 推荐使用方式

### 方式1：SSE模式 + MCP Inspector ⭐⭐⭐ 最推荐

这是最简单、最可靠的方式！

#### 步骤1：启动SSE服务器

```bash
python start_knowledge_agent_sse.py
```

你会看到：
```
============================================================
🚀 启动个人知识管理智能体 MCP服务器
============================================================
📡 传输模式: SSE (Server-Sent Events)
🌐 Web访问: http://localhost:8000
📋 MCP端点: http://localhost:8000/sse
⚠️  按Ctrl+C停止服务器
============================================================
```

#### 步骤2：使用MCP Inspector测试

MCP Inspector是官方的MCP服务器测试工具，提供可视化界面：

```bash
npx @modelcontextprotocol/inspector http://127.0.0.1:8000/sse
```

在Inspector中你可以：
- 查看所有可用的工具
- 测试每个工具的功能
- 查看工具的输入/输出
- 实时调试MCP通信

---

### 方式2：集成到AI助手（Kiro/Claude Desktop）⭐⭐⭐

#### 对于Kiro

在Kiro的MCP配置中添加：

```json
{
  "mcpServers": {
    "knowledge-agent": {
      "command": "python",
      "args": ["C:/你的路径/start_knowledge_agent_sse.py"],
      "env": {}
    }
  }
}
```

#### 对于Claude Desktop

在`claude_desktop_config.json`中添加：

```json
{
  "mcpServers": {
    "knowledge-agent": {
      "command": "python",
      "args": ["C:/你的路径/knowledge_agent_server.py"],
      "env": {}
    }
  }
}
```

---

### 方式3：直接使用stdio模式（AI助手集成）⭐⭐

如果你的AI助手支持stdio模式：

```bash
python knowledge_agent_server.py
```

这会启动stdio模式的MCP服务器，适合与AI助手直接集成。

---

## 📊 可用功能

你的知识代理提供以下10个MCP工具：

### 1. 知识管理
- **add_knowledge** - 添加新的知识项
- **get_knowledge** - 获取特定知识项
- **update_knowledge** - 更新知识项
- **delete_knowledge** - 删除知识项

### 2. 搜索功能
- **search_knowledge** - 搜索知识库（支持语义搜索）

### 3. 组织功能
- **list_categories** - 列出所有分类
- **get_relationships** - 获取知识关系图谱

### 4. 数据管理
- **export_data** - 导出知识库数据
- **import_data** - 导入知识库数据

### 5. 统计信息
- **get_statistics** - 获取知识库统计信息

---

## 🧪 测试你的服务器

### 快速测试

```bash
# 测试服务器是否正常初始化
python debug_mcp_server.py

# 测试SSE服务器
python test_sse_server.py
```

### 完整测试

```bash
# 运行所有单元测试
pytest knowledge_agent/tests/ -v

# 运行集成测试
pytest knowledge_agent/tests/test_integration.py -v
```

---

## 💡 使用示例

### 示例1：通过MCP Inspector添加知识

1. 启动服务器：`python start_knowledge_agent_sse.py`
2. 打开Inspector：`npx @modelcontextprotocol/inspector http://127.0.0.1:8000/sse`
3. 选择工具：`add_knowledge`
4. 输入参数：
   ```json
   {
     "title": "Python最佳实践",
     "content": "使用类型提示可以提高代码可读性...",
     "source_type": "document",
     "tags": ["python", "编程", "最佳实践"]
   }
   ```
5. 执行并查看结果

### 示例2：搜索知识

1. 选择工具：`search_knowledge`
2. 输入参数：
   ```json
   {
     "query": "Python",
     "max_results": 10
   }
   ```
3. 查看搜索结果

### 示例3：查看统计信息

1. 选择工具：`get_statistics`
2. 无需参数
3. 查看知识库统计

---

## 🔧 配置

### 数据库位置

默认数据库文件：`knowledge_agent.db`

### 搜索索引

默认搜索索引目录：`search_index/`

### 日志文件

日志文件位置：`logs/`

### 配置文件

配置文件：`knowledge_agent/config.yaml`

---

## ❓ 常见问题

### Q1: 为什么Web代理不工作？

**A**: Web代理使用stdio模式与MCP服务器通信，但存在兼容性问题。推荐直接使用SSE模式。

### Q2: 如何查看服务器日志？

**A**: 日志文件在`logs/`目录下，按日期命名。

### Q3: 如何重置数据库？

**A**: 删除`knowledge_agent.db`文件，服务器会自动创建新的数据库。

### Q4: 支持哪些数据源？

**A**: 
- 文档（TXT, MD）
- PDF文件
- 代码文件（Python, JavaScript等）
- 网页内容
- 图片（需要OCR支持）

### Q5: 如何导出所有数据？

**A**: 使用`export_data`工具，指定导出路径。

---

## 📚 下一步

1. ✅ 启动SSE服务器
2. ✅ 使用MCP Inspector测试所有功能
3. ✅ 添加一些测试数据
4. ✅ 尝试搜索和组织功能
5. ✅ 集成到你的AI助手中

---

## 📞 获取帮助

如果遇到问题：

1. 查看日志：`logs/`目录
2. 运行诊断：`python debug_mcp_server.py`
3. 查看文档：`tests_and_docs/`目录
4. 检查配置：`knowledge_agent/config.yaml`

---

**祝使用愉快！** 🎉

你现在有一个功能完整的个人知识管理智能体了！
